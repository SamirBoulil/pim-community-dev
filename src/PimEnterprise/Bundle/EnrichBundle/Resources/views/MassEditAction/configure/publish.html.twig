{% extends 'PimEnrichBundle:MassEditAction:configure/layout.html.twig' %}

{% set notGrantedIdentifiers = form.operation.notGrantedIdentifiers.vars.value %}
{% set nbNotGranted = notGrantedIdentifiers|trim|length == 0 ? 0 : notGrantedIdentifiers|split(', ')|length %}
{% set productCount = productCount - nbNotGranted %}

{% block head_script %}
    {{ parent() }}
    {% if productCount == 0 %}
        <script type="text/javascript">
            require(
                ['jquery'],
                function($){
                    'use strict';
                    $(function() {
                        $('a.next').hide();
                    });
                }
            );
        </script>
    {% endif %}
{% endblock %}

{% block formContent %}
    {% if productCount == 0 %}
        {% set alertClass = 'error' %}
        {% set alertMessage = 'pim_enrich.mass_edit_action.publish.message.error'|trans %}
    {% elseif nbNotGranted > 0 %}
        {% set alertClass = 'warning' %}
        {% set alertMessage = 'pim_enrich.mass_edit_action.publish.message.warning'|trans({'%notGranted%': notGrantedIdentifiers}) %}
    {% else %}
        {% set alertClass = 'info' %}
        {% set alertMessage = 'pim_enrich.mass_edit_action.publish.message.info'|trans({'%nbProducts%': productCount}) %}
    {% endif %}

    <div class="alert alert-{{ alertClass }}">
        <div class="message">
            <ul><li>{{ alertMessage }}</li></ul>
        </div>
    </div>

{% endblock %}
